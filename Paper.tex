\documentclass[winfonts,UTF8,a4paper]{ctexart}
%%package
\usepackage[lined,boxruled,commentsnumbered]{algorithm2e}
\usepackage{amsfonts}
\usepackage[figurewithin=section]{caption}
\usepackage{color}
\usepackage{fancyhdr}
\usepackage{floatrow}
\usepackage[text={160mm,247mm},left=30mm,right=20mm,includeheadfoot,vmarginratio=1:1]{geometry}
\usepackage{graphicx}
\usepackage{listings}
\usepackage[numbers,sort&compress]{natbib}
\usepackage{setspace}
\usepackage{tabularx}
\graphicspath{{graph/}}
%%Define colors
\definecolor{keywordcolor}{rgb}{0.8,0.1,0.5}
\definecolor{webgreen}{rgb}{0,0.5,0}
\definecolor{shadowcolor}{RGB}{190,190,190}
%% listings settings
\renewcommand{\lstlistingname}{代码}
\lstset{
basicstyle=\rmfamily\footnotesize,
keywordstyle=\color{keywordcolor}\bfseries, %\underbar,
commentstyle=\color{blue} \textit,
stringstyle=\ttfamily,
showstringspaces=false,
frame=shadowbox,
rulesepcolor=\color{shadowcolor},%\color{red!20!green!20!blue!20},
xleftmargin=2em,
xrightmargin=2em,
aboveskip=1em
}
%重设Code环境
\lstnewenvironment{code}[1][]%
{
   \noindent
   \minipage{\linewidth}
   \vspace{0.5\baselineskip}
   \lstset{basicstyle=\rmfamily\footnotesize,
           keywordstyle=\color{keywordcolor}\bfseries,
           commentstyle=\color{blue} \textit,
           stringstyle=\ttfamily,
           showstringspaces=false,
           frame=shadowbox,
           rulesepcolor=\color{shadowcolor},
           xleftmargin=2em,
           xrightmargin=2em,
           aboveskip=1em,#1}
}{\endminipage}
%%参数设置
\onehalfspacing %%1.5倍行距
\renewcommand{\footnotesize}{\zihao{5}}%%设置脚注字号
\floatsetup[table]{capposition=top}%%表格标题在表格上方
%页眉，页脚
\pagestyle{fancy}
\fancyhf{}
\fancyhead[C]{\zihao{-5} 暨南大学本科课程论文}
%重设节标题
\CTEXsetup[format={\zihao{-2}\songti\bf\flushleft}]{section}
\CTEXsetup[format+={\zihao{4}\songti}]{subsection}
\CTEXsetup[format+={\zihao{4}\songti}]{subsubsection}
%重设图片、表格标号
\makeatletter
    \renewcommand{\thefigure}{\ifnum \c@section>\z@ \thesection-\fi \@arabic\c@figure}
    \renewcommand{\thetable}{\ifnum \c@section>\z@ \thesection-\fi \@arabic\c@table}
\makeatother
%重设目录格式
%\usepackage{titletoc}
%\titlecontents{section}[2em]{\vspace{3mm}\zihao{4}\songti\bf}{\contentslabel{1.7em}}%
%    {}{\bf\titlerule*[0.5pc]{$\cdot$}\zihao{4}\contentspage}
%\titlecontents{subsection}[2.5em]{\zihao{-4}\songti}{\thecontentslabel}%
%    {}{\titlerule*[0.5pc]{$\cdot$}\zihao{-4}\contentspage}
%\titlecontents{subsubsection}[2.5em]{\zihao{5}\songti}{\thecontentslabel}%
%    {}{\titlerule*[0.5pc]{$\cdot$}\zihao{5}\contentspage}

\begin{document}
  %%--------------- 前言 ----------------- %%
    \include{chapter/declaration}
    \include{chapter/abstract}
    \tableofcontents
 \thispagestyle{empty}
 \newpage

%%----------------- 正文 ----------------- %%

%重设页眉，页脚
\pagestyle{fancy}
\fancyhf{}
\fancyhead[C]{\zihao{-5} 可视化的Java多线程程序错误定位工具}
\fancyfoot[R]{\thepage}
%重设页码
\setcounter{page}{1}
\pagenumbering{arabic}
    \include{chapter/chap1}
    \include{chapter/chap2}
    \include{chapter/chap3}
    \include{chapter/chap4}
%%----------------- 附件 ----------------- %%
    \include{chapter/thanks}
    \bibliographystyle{GBT7714-2005NLang}
    \bibliography{reference}
\end{document}
